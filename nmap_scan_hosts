#!/bin/bash

echo " "
echo "▒█▄░▒█ ▒█▀▄▀█ ░█▀▀█ ▒█▀▀█ 　 █▀▀█ █░░█ ▀▀█▀▀ █▀▀█ █▀▄▀█ █▀▀█ ▀▀█▀▀ █▀▀█ █▀▀█ "
echo "▒█▒█▒█ ▒█▒█▒█ ▒█▄▄█ ▒█▄▄█ 　 █▄▄█ █░░█ ░░█░░ █░░█ █░▀░█ █▄▄█ ░░█░░ █░░█ █▄▄▀ "
echo "▒█░░▀█ ▒█░░▒█ ▒█░▒█ ▒█░░░ 　 ▀░░▀ ░▀▀▀ ░░▀░░ ▀▀▀▀ ▀░░░▀ ▀░░▀ ░░▀░░ ▀▀▀▀ ▀░▀▀ "
echo ""
echo "Automating Nmap for pentests"
echo "Currently you can automate these tasks with the script: port scanning, host discovery"
echo " "
read -p  "Enter an IP of the subnet you want to scan: " host
read -p "Enter the netmask of the target IP-range: " netmask

if [[ "$netmask" == "255.255.255.0" ]]
then
    echo "[+] Starting scan..."
    nmap -sn $host/24 | cut -d" " -f5,6 | grep -v "latency"
    echo ""
    echo "Do you want to scan the hosts for open ports (y/n) "
    read scan_y_n
        if [[ "$scan_y_n" == "y" ]];
            then
            echo "[+] Nmap script executed! All hosts have been discovered."
            echo "[+] Scanning targets for open ports now..."
   	    nmap -sn $host/24 | cut -d" " -f5 | grep 1 | xargs nmap
        elif [[ "$scan_y_n" == "n" ]];
            then
            echo "[*] Exiting"
        else
            echo "[!] Error!"
            exit 1
	fi

elif [[ "$netmask" == "255.255.0.0" ]]
then
    echo "[+] Starting scan..."
    nmap -sn $host/16 | cut -d" " -f5,6 | grep -v "latency"
    echo ""
    echo "Do you want to scan the hosts for open ports (y/n) "
    read scan_y_n
        if [[ "$scan_y_n" == "y" ]];
        then
            echo "[+] Nmap script executed! All hosts have been discovered."
            echo "[+] Scanning targets for open ports now..."
            nmap -sn $host/24 | cut -d" " -f5 | grep 1 | xargs nmap
        elif [[ "$scan_y_n" == "n" ]];
        then
            echo "[*] Exiting"
        else
            echo "[!] Error! "
	    exit 1
        fi
elif [[ "$netmask" == "255.0.0.0" ]]
then
    echo "[+] Starting scan..."
    nmap -sn $host/8 | cut -d" " -f5,6 | grep -v "latency"
    echo ""
    echo "Do you want to scan the hosts for open ports (y/n) "
    read scan_y_n
        if [[ "$scan_y_n" == "y" ]];
        then
            echo "[+] Nmap script executed! All hosts have been discovered."
            echo "[+] Scanning targets for open ports now..."
            nmap -sn $host/24 | cut -d" " -f5 | grep 1 | xargs nmap
        elif [[ "$scan_y_n" == "n" ]];
        then
            echo "[*] Exiting"
        else
            echo "[!] Error!"
            exit 1
        fi

else
    ./nmap_scan_hosts.sh
    echo "[!] Invalid/not supported netmask"
    exit 1
fi
